function show_map(e){var t=e.coords.latitude,o=e.coords.longitude,n=new google.maps.LatLng(t,o),a={scrollwheel:!0,zoom:17,center:n,panControl:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,draggable:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("the-map"),a),map.setOptions({styles:style});var i={path:"M 0,-1 0,1",strokeOpacity:1,scale:4};traces=new google.maps.Polyline({path:coords,strokeColor:"#00C7FF",strokeOpacity:.1,strokeWeight:10,icons:[{icon:i,offset:"0",repeat:"20px"}]}),traces.setMap(map)}function show_map2(){var e=50.85,t=4.35,o=new google.maps.LatLng(e,t),n={scrollwheel:!0,zoom:17,center:o,panControl:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,draggable:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("the-map"),n),map.setOptions({styles:style});var a={path:"M 0,-1 0,1",strokeOpacity:1,scale:4};traces=new google.maps.Polyline({path:coords,strokeColor:"#00C7FF",strokeOpacity:.1,strokeWeight:10,icons:[{icon:a,offset:"0",repeat:"20px"}]}),traces.setMap(map)}function error(){alert("please position")}function getR(e,t){return Math.random()*(t-e)+e}function round(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}function closeControls(){$(".pin-details").velocity("transition.slideUpOut",{duration:400}),$(".main").velocity({translateY:["0vh","20vh"],scale:1},{duration:300}),$(".close-input").velocity("transition.flipXOut",{delay:0,duration:0}).velocity({scale:1},0),$(".pin-overlay").velocity({scale:1},200)}function openControls(){$(".main").velocity({translateY:["20vh",0],scale:[2,1]},{duration:300}),$(".pin-details").velocity("transition.slideDownIn",{duration:300,delay:150}),$(".close-input").velocity("transition.flipXIn",{delay:200}).velocity({scale:1.6},200)}function closeReview(){$(".route-review").velocity({translateY:"0vh"},{duration:400,easing:"easeOutQuint"}),$(".info-stuff").velocity("transition.flipXOut",{display:null,duration:0})}function openReview(){$(".route-review").velocity({translateY:"-100vh"},{duration:400,easing:"easeOutQuint"}),$(".info-stuff").velocity("transition.flipXIn",{display:null,stagger:100,delay:300})}function openTipInput(){$(".tip-input").velocity({translateY:"100%"},{duration:400,easing:"easeOutQuint",complete:function(){$("input").focus()}})}function closeTipInput(){$(".tip-input").velocity({translateY:"-100%"},{duration:400,easing:"easeOutQuint"}),$("input").blur()}function openTipEdit(e){for(var t,o,n=0;n<myCoords.length;n++){var a=myCoords[n].location;e.k===a.k&&e.D===a.D&&(t=myCoords[n],o=n)}console.log("Found! Tip #"+o),$("#tip-delete").velocity({translateY:"100vh"},{duration:600,easing:[200,20]})}function closeTipDelete(){$("#tip-delete").velocity({translateY:"-100vh"},{duration:600,easing:[200,20]})}function addCoordsToPath(){var e=new google.maps.Marker({position:map.getCenter(),map:map,icon:{path:google.maps.SymbolPath.CIRCLE,scale:7}}),t=traces.getPath();t.push(map.getCenter());var o=$("#add-tip").html(),n={tip:o,location:map.getCenter(),zoom:map.getZoom()};myCoords.push(n),google.maps.event.addListener(e,"click",function(){openTipEdit(e.getPosition()),map.setZoom(map.getZoom()),map.panTo(e.getPosition())});var a=traces.inKm();$(".stop-number").find(".round-numbers").html(myCoords.length),$(".length").find(".round-numbers").html(round(a,2)),$(".duration").find(".round-numbers").html(round(a/3,2)),$(".tip-input-form").val(""),$("#add-tip").html("add tip?")}function makeThingsStick(){$("section").css("height",windowHeight+"px")}var map,geocoder,traces,coords=[],traces,myCoords=[],google;google.maps.LatLng.prototype.kmTo=function(e){var t=Math,o=t.PI/180,n=this.lat()*o,a=e.lat()*o,i=n-a,s=this.lng()*o-e.lng()*o,r=2*t.asin(t.sqrt(t.pow(t.sin(i/2),2)+t.cos(n)*t.cos(a)*t.pow(t.sin(s/2),2)));return 6378.137*r},google.maps.Polyline.prototype.inKm=function(e){for(var t=this.getPath(e),o=t.getLength(),n=0,a=0;o-1>a;a++)n+=t.getAt(a).kmTo(t.getAt(a+1));return n};var style=[{stylers:[{hue:"#ff1a00"},{invert_lightness:!0},{saturation:-100},{lightness:33},{gamma:.9}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#2D333C"}]}],myFirebaseRef,windowHeight;$(window).load(function(){windowHeight=window.innerHeight,windowWidth=window.innerWidth,myFirebaseRef=new Firebase("https://hint-hunt.firebaseio.com");var e="closed",t,o;$(".pin-details").hammer().on("pan",function(e){e.stopPropagation();var t,o,n,a;t=e.gesture.deltaX/10,o=e.gesture.deltaY/10,n=e.gesture.pointers[0].pageX,a=e.gesture.pointers[0].pageY,console.log(e),$(this).css("left",n-windowWidth/2),$(this).css("top",a-windowHeight/2)}),$(".pin-details").hammer().on("panend",function(e){});var n=0;$(".route-review").hammer().on("pandown",function(e){e.stopPropagation();var t=100/windowHeight*e.gesture.deltaY-100;n=-t,$(this).velocity({translateY:t+"%"},0)}),$(".route-review").hammer().on("panend",function(t){n>60?$(this).velocity({translateY:"-100vh"},{duration:200}):(closeReview(),e="closed")}),$(".save-route").hammer().on("tap",function(){"closed"===e&&(openReview(),deltaY=0,e="review")}),$(".save-share").hammer().on("tap",function(){var e=myFirebaseRef.child("routes"),t=e.push(myCoords);$(this).html(t.key()),$(this).css("font-size","16px")}),$(".close-input").hammer().on("tap",function(t){"open"===e&&(t.preventDefault(),closeControls(),addCoordsToPath(),e="closed")}),$(".pin-details").hammer().on("tap",function(e){}),$(".pin-overlay").hammer().on("tap",function(t){$(this).velocity({scale:.4},300),$("#waypoint-number").html("#"+(myCoords.length+1)),$("#path-length").html("Length: "+Math.round(100*traces.inKm())/100+"km"),"closed"===e&&(openControls(),e="open")}),$("#add-tip").hammer().on("tap",function(e){openTipInput()}),$("#tip-form").on("submit",function(e){e.preventDefault();var t=$(".tip-input-form").val();console.log(t),$("#add-tip").html(t),closeTipInput()}),$(".close-tip-delete").hammer().on("tap",function(){closeTipDelete()}),show_map2()});