function show_map(t){var e=t.coords.latitude,n=t.coords.longitude,s=new google.maps.LatLng(e,n),o={scrollwheel:!0,zoom:17,center:s,panControl:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,draggable:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("the-map"),o),map.setOptions({styles:style});var i={path:"M 0,-1 0,1",strokeOpacity:1,scale:4};traces=new google.maps.Polyline({path:coords,strokeColor:"#00C7FF",strokeOpacity:.1,strokeWeight:10,icons:[{icon:i,offset:"0",repeat:"20px"}]}),traces.setMap(map)}function show_map2(){var t=50.85,e=4.35,n=new google.maps.LatLng(t,e),s={scrollwheel:!0,zoom:17,center:n,panControl:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,draggable:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("the-map"),s),map.setOptions({styles:style});var o={path:"M 0,-1 0,1",strokeOpacity:1,scale:4};traces=new google.maps.Polyline({path:coords,strokeColor:"#00C7FF",strokeOpacity:.1,strokeWeight:10,icons:[{icon:o,offset:"0",repeat:"20px"}]}),traces.setMap(map)}function error(){alert("please position")}function getR(t,e){return Math.random()*(e-t)+t}function round(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)}function closeControls(){$(".pin-details").velocity("transition.slideUpOut",{duration:400}),$(".main").velocity({translateY:["0vh","20vh"],scale:1},{duration:300}),$(".close-input").velocity("transition.flipXOut",{delay:0,duration:0}).velocity({scale:1},0),$(".pin-overlay").velocity({scale:1},200)}function openControls(){$(".main").velocity({translateY:["20vh",0],scale:[2,1]},{duration:300}),$(".pin-details").velocity("transition.slideDownIn",{duration:300,delay:150}),$(".close-input").velocity("transition.flipXIn",{delay:200}).velocity({scale:1.6},200)}function closeReview(){$(".route-review").velocity({translateY:"0vh"},{duration:400,easing:"easeOutQuint"}),$(".info-stuff").velocity("transition.flipXOut",{display:null,duration:0})}function openReview(){$(".route-review").velocity({translateY:"-100vh"},{duration:400,easing:"easeOutQuint"}),$(".info-stuff").velocity("transition.flipXIn",{display:null,stagger:100,delay:300})}function openTipInput(){$(".tip-input").velocity({translateY:"100%"},{duration:400,easing:"easeOutQuint",complete:function(){$("input").focus()}})}function closeTipInput(){$(".tip-input").velocity({translateY:"-100%"},{duration:400,easing:"easeOutQuint"}),$("input").blur()}function openTipEdit(t){for(var e,n,s=0;s<myCoords.length;s++){var o=myCoords[s].location;t.k===o.k&&t.D===o.D&&(e=myCoords[s],n=s)}console.log("Found! Tip #"+n),$("#tip-delete").velocity({translateY:"100vh"},{duration:600,easing:[200,20]})}function closeTipDelete(){$("#tip-delete").velocity({translateY:"-100vh"},{duration:600,easing:[200,20]})}function addCoordsToPath(){var t=new google.maps.Marker({position:map.getCenter(),map:map,icon:{path:google.maps.SymbolPath.CIRCLE,scale:7}}),e=traces.getPath();e.push(map.getCenter());var n=$("#add-tip").html(),s={tip:n,location:map.getCenter(),zoom:map.getZoom()};myCoords.push(s),google.maps.event.addListener(t,"click",function(){openTipEdit(t.getPosition()),map.setZoom(map.getZoom()),map.panTo(t.getPosition())});var o=traces.inKm();$(".stop-number").find(".round-numbers").html(myCoords.length),$(".length").find(".round-numbers").html(round(o,2)),$(".duration").find(".round-numbers").html(round(o/3,2)),$(".tip-input-form").val(""),$("#add-tip").html("add tip?")}function makeThingsStick(){$("section").css("height",windowHeight+"px")}var Hashids=function(){"use strict";function t(t,e,n){var s,o,i,a,r,h,l;for(this.version="1.0.2",this.minAlphabetLength=16,this.sepDiv=3.5,this.guardDiv=12,this.errorAlphabetLength="error: alphabet must contain at least X unique characters",this.errorAlphabetSpace="error: alphabet cannot contain spaces",this.alphabet="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",this.seps="cfhistuCFHISTU",this.minHashLength=parseInt(e,10)>0?e:0,this.salt="string"==typeof t?t:"","string"==typeof n&&(this.alphabet=n),s="",o=0,a=this.alphabet.length;o!==a;o++)-1===s.indexOf(this.alphabet.charAt(o))&&(s+=this.alphabet.charAt(o));if(this.alphabet=s,this.alphabet.length<this.minAlphabetLength)throw this.errorAlphabetLength.replace("X",this.minAlphabetLength);if(-1!==this.alphabet.search(" "))throw this.errorAlphabetSpace;for(o=0,a=this.seps.length;o!==a;o++)i=this.alphabet.indexOf(this.seps.charAt(o)),-1===i?this.seps=this.seps.substr(0,o)+" "+this.seps.substr(o+1):this.alphabet=this.alphabet.substr(0,i)+" "+this.alphabet.substr(i+1);this.alphabet=this.alphabet.replace(/ /g,""),this.seps=this.seps.replace(/ /g,""),this.seps=this.consistentShuffle(this.seps,this.salt),(!this.seps.length||this.alphabet.length/this.seps.length>this.sepDiv)&&(r=Math.ceil(this.alphabet.length/this.sepDiv),1===r&&r++,r>this.seps.length?(h=r-this.seps.length,this.seps+=this.alphabet.substr(0,h),this.alphabet=this.alphabet.substr(h)):this.seps=this.seps.substr(0,r)),this.alphabet=this.consistentShuffle(this.alphabet,this.salt),l=Math.ceil(this.alphabet.length/this.guardDiv),this.alphabet.length<3?(this.guards=this.seps.substr(0,l),this.seps=this.seps.substr(l)):(this.guards=this.alphabet.substr(0,l),this.alphabet=this.alphabet.substr(l))}return t.prototype.encode=function(){var t="",e,n,s=Array.prototype.slice.call(arguments);if(!s.length)return t;for(s[0]instanceof Array&&(s=s[0]),e=0,n=s.length;e!==n;e++)if("number"!=typeof s[e]||s[e]%1!==0||s[e]<0)return t;return this._encode(s)},t.prototype.decode=function(t){var e=[];return t.length&&"string"==typeof t?this._decode(t,this.alphabet):e},t.prototype.encodeHex=function(t){var e,n,s;if(t=t.toString(),!/^[0-9a-fA-F]+$/.test(t))return"";for(s=t.match(/[\w\W]{1,12}/g),e=0,n=s.length;e!==n;e++)s[e]=parseInt("1"+s[e],16);return this.encode.apply(this,s)},t.prototype.decodeHex=function(t){var e=[],n,s,o=this.decode(t);for(n=0,s=o.length;n!==s;n++)e+=o[n].toString(16).substr(1);return e},t.prototype._encode=function(t){var e,n,s,o,i,a,r,h,l,p,c,u,g=this.alphabet,d=t.length,m=0;for(s=0,o=t.length;s!==o;s++)m+=t[s]%(s+100);for(n=e=g.charAt(m%g.length),s=0,o=t.length;s!==o;s++)i=t[s],a=n+this.salt+g,g=this.consistentShuffle(g,a.substr(0,g.length)),r=this.hash(i,g),e+=r,d>s+1&&(i%=r.charCodeAt(0)+s,h=i%this.seps.length,e+=this.seps.charAt(h));for(e.length<this.minHashLength&&(l=(m+e[0].charCodeAt(0))%this.guards.length,p=this.guards[l],e=p+e,e.length<this.minHashLength&&(l=(m+e[2].charCodeAt(0))%this.guards.length,p=this.guards[l],e+=p)),c=parseInt(g.length/2,10);e.length<this.minHashLength;)g=this.consistentShuffle(g,g),e=g.substr(c)+e+g.substr(0,c),u=e.length-this.minHashLength,u>0&&(e=e.substr(u/2,this.minHashLength));return e},t.prototype._decode=function(t,e){var n=[],s=0,o,i,a,r,h=new RegExp("["+this.guards+"]","g"),l=t.replace(h," "),p=l.split(" ");if((3===p.length||2===p.length)&&(s=1),l=p[s],"undefined"!=typeof l[0]){for(o=l[0],l=l.substr(1),h=new RegExp("["+this.seps+"]","g"),l=l.replace(h," "),p=l.split(" "),s=0,i=p.length;s!==i;s++)a=p[s],r=o+this.salt+e,e=this.consistentShuffle(e,r.substr(0,e.length)),n.push(this.unhash(a,e));this._encode(n)!==t&&(n=[])}return n},t.prototype.consistentShuffle=function(t,e){var n,s,o,i,a,r;if(!e.length)return t;for(i=t.length-1,a=0,r=0;i>0;i--,a++)a%=e.length,r+=n=e.charAt(a).charCodeAt(0),s=(n+a+r)%i,o=t.charAt(s),t=t.substr(0,s)+t.charAt(i)+t.substr(s+1),t=t.substr(0,i)+o+t.substr(i+1);return t},t.prototype.hash=function(t,e){var n="",s=e.length;do n=e.charAt(t%s)+n,t=parseInt(t/s,10);while(t);return n},t.prototype.unhash=function(t,e){var n=0,s,o;for(o=0;o<t.length;o++)s=e.indexOf(t[o]),n+=s*Math.pow(e.length,t.length-o-1);return n},"function"==typeof define&&"object"==typeof define.amd&&define.amd&&define(function(){return t}),t}(),map,geocoder,traces,coords=[],traces,myCoords=[],google;google.maps.LatLng.prototype.kmTo=function(t){var e=Math,n=e.PI/180,s=this.lat()*n,o=t.lat()*n,i=s-o,a=this.lng()*n-t.lng()*n,r=2*e.asin(e.sqrt(e.pow(e.sin(i/2),2)+e.cos(s)*e.cos(o)*e.pow(e.sin(a/2),2)));return 6378.137*r},google.maps.Polyline.prototype.inKm=function(t){for(var e=this.getPath(t),n=e.getLength(),s=0,o=0;n-1>o;o++)s+=e.getAt(o).kmTo(e.getAt(o+1));return s};var style=[{stylers:[{hue:"#ff1a00"},{invert_lightness:!0},{saturation:-100},{lightness:33},{gamma:.9}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#2D333C"}]}],myFirebaseRef,windowHeight;$(window).load(function(){windowHeight=window.innerHeight,windowWidth=window.innerWidth,myFirebaseRef=new Firebase("https://hint-hunt.firebaseio.com");var t="closed",e,n;$(".pin-details").hammer().on("pan",function(t){t.stopPropagation();var e,n,s,o;e=t.gesture.deltaX/10,n=t.gesture.deltaY/10,s=t.gesture.pointers[0].pageX,o=t.gesture.pointers[0].pageY,console.log(t),$(this).css("left",s-windowWidth/2),$(this).css("top",o-windowHeight/2)}),$(".pin-details").hammer().on("panend",function(t){});var s=0;$(".route-review").hammer().on("pandown",function(t){t.stopPropagation();var e=100/windowHeight*t.gesture.deltaY-100;s=-e,$(this).velocity({translateY:e+"%"},0)}),$(".route-review").hammer().on("panend",function(e){s>60?$(this).velocity({translateY:"-100vh"},{duration:200}):(closeReview(),t="closed")}),$(".save-route").hammer().on("tap",function(){"closed"===t&&(openReview(),deltaY=0,t="review")}),$(".save-share").hammer().on("tap",function(){var t=$(this),e=myFirebaseRef.child("routes"),n,s=myFirebaseRef.child("count");s.transaction(function(t){return t+1},function(s,o,i){n=parseInt(i.val());var a=new Hashids("hinthunt",4,"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"),r=a.encode(n),h=e.child(r);h.set(myCoords),$(t).html(r)})}),$(".close-input").hammer().on("tap",function(e){"open"===t&&(e.preventDefault(),closeControls(),addCoordsToPath(),t="closed")}),$(".pin-details").hammer().on("tap",function(t){}),$(".pin-overlay").hammer().on("tap",function(e){$(this).velocity({scale:.4},300),$("#waypoint-number").html("#"+(myCoords.length+1)),$("#path-length").html("Length: "+Math.round(100*traces.inKm())/100+"km"),"closed"===t&&(openControls(),t="open")}),$("#add-tip").hammer().on("tap",function(t){openTipInput()}),$("#tip-form").on("submit",function(t){t.preventDefault();var e=$(".tip-input-form").val();console.log(e),$("#add-tip").html(e),closeTipInput()}),$(".close-tip-delete").hammer().on("tap",function(){closeTipDelete()}),show_map2()});